---
id: package-x-cron-bundle
title: Cronjobs
---

import { PackageHeader } from "@site/src/components/PackageHeader";

<PackageHeader version="1.0.0" packageName="x-cron-bundle"  />

This tool allows you to run recurrent jobs in your X Framework ecosystem. The cronjobs which are running will have their result stored in "crons" collection.

## Setting up

```bash
npm i -S @kaviar/x-cron-bundle
```

```ts
import { XCronBundle } from "@kaviar/x-cron-bundle";

const kernel = new Kernel({
  bundles: [
    // the others
    new XCronBundle(),
  ],
});
```

## Adding a Cronjob

```ts
import { CronService } from "@kaviar/x-cron-bundle";

class AppBundle extends Bundle {
  async init() {
    const cronService = this.container.get(CronService);
    cronService.add({
      name: "Send reminders",
      schedule(parser) {
        // Parser is an instance of Later.parse(), can be configured in many forms
        // http://bunkat.github.io/later/parsers.html#cron
        return parser.text("every 2 hours");
      },
      async job(container) {
        const myService = container.get(MyService);
        await myService.process();

        // Ensure the job is blocking (use await) so we can properly keep track the execution
      },
    });
  }
}
```

Consider storing your cronjobs in a separate file and just add them here:

```ts title="cronjobs.ts"
import { ICronConfig } from "@kaviar/x-cron-bundle";

export const cronfigs: ICronConfig[] = [
  {
    name: "Do this, do that",
    // ... the rest
  },
];
```

If you want to schedule to run at 8:00 am in your local time zone, please note the time in `parser` is in UTC and adapt accordingly.
